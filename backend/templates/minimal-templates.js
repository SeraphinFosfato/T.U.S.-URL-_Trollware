// Template minimalisti per ridurre bandwidth
const minimalTemplates = {
  timer: (id, duration, nextUrl) => `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Loading</title><style>body{font-family:Arial;background:#f0f0f0;margin:0;padding:20px;display:flex;align-items:center;justify-content:center;min-height:100vh}.w{background:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 6px rgba(0,0,0,0.1);max-width:400px;text-align:center}.t{font-size:48px;color:#007bff;font-weight:bold;margin:20px 0}.p{width:100%;background:#e0e0e0;border-radius:10px;overflow:hidden;margin:20px 0;height:20px}.f{height:100%;background:#007bff;width:0%;transition:width 0.8s ease-out}.b{padding:15px 30px;font-size:18px;background:#28a745;color:#fff;border:none;border-radius:5px;cursor:pointer;margin-top:20px;display:none}.warn{color:#dc3545;font-weight:bold;display:none}</style></head><body><div class="w"><h2>üîÑ Loading...</h2><div class="t" id="t">${duration}</div><div class="p"><div class="f" id="f"></div></div><p id="s">Please wait</p><p class="warn" id="w">‚ö†Ô∏è Keep window active!</p><button class="b" id="b" onclick="location.href='${nextUrl}'">Continue</button></div><script>let s=${duration},i=null,paused=false,lastMouse=Date.now(),resuming=false;function start(){if(i)return;i=setInterval(()=>{if(paused||resuming||document.hidden||!document.hasFocus())return;s--;document.getElementById('t').textContent=s;document.getElementById('f').style.width=((${duration}-s)/${duration})*100+'%';if(s<=0){clearInterval(i);document.getElementById('s').textContent='‚úÖ Complete!';document.getElementById('b').style.display='inline-block';document.getElementById('t').style.color='#28a745'}},1000)}function pause(){if(paused||resuming)return;paused=true;document.getElementById('w').style.display='block';document.getElementById('s').textContent='‚ö†Ô∏è Keep window active!'}function resume(){if(!paused||resuming)return;resuming=true;setTimeout(()=>{document.getElementById('s').textContent='üîÑ Resuming timer...';const resumeTime=2000+Math.random()*3000;setTimeout(()=>{resuming=false;paused=false;document.getElementById('w').style.display='none';document.getElementById('s').textContent='Please wait'},resumeTime)},1500)}document.addEventListener('mousemove',()=>{lastMouse=Date.now();if(paused&&!resuming)resume()});document.addEventListener('visibilitychange',()=>{if(document.hidden)pause();else if(paused&&!resuming)resume()});window.addEventListener('focus',()=>{if(paused&&!resuming)resume()});window.addEventListener('blur',pause);setInterval(()=>{if(Date.now()-lastMouse>3000&&!paused&&!resuming)pause()},1000);setInterval(()=>{if((document.hidden||!document.hasFocus()||Date.now()-lastMouse>5000)&&!resuming&&!paused)pause()},2000);start()</script></body></html>`,
  
  click: (id, target, nextUrl) => `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Loading</title><style>body{font-family:Arial;background:#f0f0f0;margin:0;padding:20px;display:flex;align-items:center;justify-content:center;min-height:100vh}.w{background:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 6px rgba(0,0,0,0.1);max-width:400px;text-align:center}.b{background:#007bff;color:#fff;border:none;padding:15px 30px;font-size:18px;border-radius:5px;cursor:pointer;margin:15px;transition:all 0.2s}.b:hover{background:#0056b3;transform:scale(1.05)}.b:disabled{background:#6c757d;cursor:not-allowed;transform:none}.p{width:100%;background:#e0e0e0;border-radius:10px;height:8px;margin:15px 0;overflow:hidden}.pf{height:100%;background:#28a745;width:0%;transition:width 0.3s ease}</style></head><body><div class="w"><h3>üéØ Click Challenge</h3><div id="pt">0/${target} clicks</div><div class="p"><div class="pf" id="pf"></div></div><button class="b" id="b" onclick="c()">Click Here</button></div><script>let n=0,lastClick=0;function c(){const now=Date.now();if(now-lastClick<500||n>=${target})return;lastClick=now;n++;document.getElementById('pt').textContent=n+'/${target} clicks';document.getElementById('pf').style.width=(n/${target})*100+'%';const btn=document.getElementById('b');btn.disabled=true;setTimeout(()=>btn.disabled=false,500);if(n>=${target}){btn.textContent='Continue';btn.onclick=()=>location.href='${nextUrl}';btn.disabled=false;btn.style.background='#28a745'}}</script></body></html>`,
  
  timer_punish: (id, duration, nextUrl) => `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Loading</title><style>body{font-family:'MS Sans Serif',sans-serif;background:#c0c0c0;margin:0;padding:0;display:flex;align-items:center;justify-content:center;min-height:100vh;font-size:11px}.w{background:#c0c0c0;border:2px outset #c0c0c0;padding:15px;width:300px;box-shadow:2px 2px 4px rgba(0,0,0,0.3)}.title{margin-bottom:10px;font-weight:bold}.t{font-family:'Courier New',monospace;font-size:24px;color:#000080;margin:10px 0;text-align:center;background:#ffffff;border:1px inset #c0c0c0;padding:8px}.p{width:100%;height:20px;background:#ffffff;border:1px inset #c0c0c0;margin:10px 0;overflow:hidden}.f{height:100%;background:#000080;width:0%;transition:none}.status{margin:10px 0;color:#000000}.b{background:#c0c0c0;border:1px outset #c0c0c0;padding:4px 12px;font-size:11px;cursor:pointer;margin-top:10px;display:none;color:#000000}.b:hover{background:#d4d4d4}.b:active{border:1px inset #c0c0c0}</style></head><body><div class="w"><div class="title">Loading in progress...</div><div class="t" id="t">${duration}</div><div class="p"><div class="f" id="f"></div></div><div class="status" id="s">Please wait for completion</div><button class="b" id="b" onclick="location.href='${nextUrl}'">Continue</button></div><script>let s=${duration},orig=${duration},i=null,lastMouse=Date.now(),reloading=false;function start(){if(i||reloading)return;i=setInterval(()=>{if(document.hidden||!document.hasFocus()||reloading)return;s--;document.getElementById('t').textContent=s;document.getElementById('f').style.width=((orig-s)/orig)*100+'%';if(s<=0){clearInterval(i);i=null;document.getElementById('s').textContent='Completed';document.getElementById('b').style.display='inline-block';document.getElementById('t').textContent='OK';document.getElementById('b').style.color='#000000'}},1000)}function reload(){if(reloading)return;reloading=true;if('Notification'in window&&Notification.permission==='granted'){new Notification('‚ö†Ô∏è Active Waiting Required',{body:'Timer reset due to inactivity.'})}document.getElementById('s').textContent='Reloading due to inactivity...';setTimeout(()=>location.reload(),1500)}document.addEventListener('mousemove',()=>lastMouse=Date.now());document.addEventListener('visibilitychange',()=>{if(document.hidden&&!reloading)reload()});window.addEventListener('blur',()=>{if(!reloading)reload()});let idleCheck=setInterval(()=>{if(Date.now()-lastMouse>2000&&!reloading){clearInterval(idleCheck);reload()}},1000);if('Notification'in window&&Notification.permission!=='granted'){Notification.requestPermission()}start()</script></body></html>`,
  
  click_teleport: (id, target, nextUrl) => `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Loading</title><style>body{font-family:Arial;background:#f0f0f0;margin:0;padding:0;min-height:100vh;position:relative;overflow:hidden;display:flex;align-items:center;justify-content:center}.w{background:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 6px rgba(0,0,0,0.1);max-width:400px;text-align:center;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:10}.b{background:#007bff;color:#fff;border:none;padding:15px 30px;font-size:18px;border-radius:5px;cursor:pointer;transition:all 0.2s;position:absolute;z-index:100}.b:hover{background:#0056b3;transform:scale(1.05)}.b:disabled{background:#6c757d;cursor:not-allowed;transform:none}.barrier{position:absolute;width:80px;height:60px;z-index:99;pointer-events:none;border:2px dashed transparent}.orb{position:absolute;width:20px;height:20px;background:radial-gradient(circle,#ff6b6b,#ee5a52);border-radius:50%;box-shadow:0 0 10px rgba(255,107,107,0.5);z-index:5;animation:float 2s ease-in-out infinite}.p{width:100%;background:#e0e0e0;border-radius:10px;height:8px;margin:15px 0;overflow:hidden}.pf{height:100%;background:#28a745;width:0%;transition:width 0.3s ease}@keyframes float{0%,100%{transform:translateY(0px)}50%{transform:translateY(-10px)}}</style></head><body><div class="w"><h3>üîÆ Teleporting Challenge</h3><div id="pt">0/${target} clicks</div><div class="p"><div class="pf" id="pf"></div></div><div class="orb" id="orb"></div></div><button class="b" id="b" onclick="c()">Click Me!</button><div class="barrier" id="barrier"></div><script>let n=0,lastClick=0,teleporting=false,idleTimer=null;function getRandomPosition(){const margin=80;const maxX=window.innerWidth-margin;const maxY=window.innerHeight-margin;return{x:Math.random()*(maxX-margin)+margin,y:Math.random()*(maxY-margin)+margin}}function teleportButton(){if(teleporting||n>=${target})return;teleporting=true;const btn=document.getElementById('b');const barrier=document.getElementById('barrier');const pos=getRandomPosition();btn.style.left=pos.x+'px';btn.style.top=pos.y+'px';barrier.style.left=(pos.x-25)+'px';barrier.style.top=(pos.y-15)+'px';setTimeout(()=>teleporting=false,100);resetIdleTimer()}function resetIdleTimer(){clearTimeout(idleTimer);if(n<${target}){idleTimer=setTimeout(teleportButton,5000)}}function c(){const now=Date.now();if(now-lastClick<500||n>=${target})return;lastClick=now;n++;document.getElementById('pt').textContent=n+'/${target} clicks';document.getElementById('pf').style.width=(n/${target})*100+'%';const btn=document.getElementById('b');btn.disabled=true;setTimeout(()=>btn.disabled=false,500);teleportButton();if(n>=${target}){clearTimeout(idleTimer);btn.textContent='Continue';btn.onclick=()=>location.href='${nextUrl}';btn.disabled=false;btn.style.background='#28a745';btn.style.position='relative';btn.style.left='auto';btn.style.top='auto';document.getElementById('barrier').style.display='none'}}document.getElementById('b').addEventListener('mouseenter',()=>{if(Math.random()<0.35&&n<${target}){setTimeout(teleportButton,50)}});document.getElementById('barrier').addEventListener('mouseenter',()=>{if(Math.random()<0.1&&n<${target}){teleportButton()}});teleportButton();resetIdleTimer()</script></body></html>`,
  
  click_racing: (id, params, nextUrl) => `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Loading</title><style>body{font-family:Arial;background:#f0f0f0;margin:0;padding:0;min-height:100vh;display:flex;align-items:center;justify-content:center}.w{background:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 6px rgba(0,0,0,0.1);max-width:450px;text-align:center;position:relative}.b{background:#dc3545;color:#fff;border:none;padding:20px 40px;font-size:20px;border-radius:5px;cursor:pointer;margin:20px;user-select:none;transition:all 0.1s}.b:active{background:#c82333;transform:scale(0.95)}.p{width:100%;background:#e0e0e0;border-radius:15px;height:35px;margin:20px 0;overflow:hidden;position:relative;border:2px solid #ccc}.pf{height:100%;background:linear-gradient(90deg,#28a745,#20c997);width:0%;transition:width 0.1s ease;position:relative}.pd{height:100%;background:linear-gradient(270deg,#dc3545,#c82333);width:0%;position:absolute;top:0;right:0;transition:width 0.1s ease}.status{font-size:18px;font-weight:bold;color:#dc3545;margin:10px 0}.diff{font-size:14px;color:#666;margin:5px 0}</style></head><body><div class="w"><h3>üèÅ Racing Challenge</h3><div class="status" id="status">Click fast to fill the green bar!</div><div class="diff" id="diff">Difficulty: ${params.name || 'medium'}</div><div class="p"><div class="pf" id="pf"></div><div class="pd" id="pd"></div></div><button class="b" id="b" onmousedown="c()" onmouseup="stop()" ontouchstart="c()" ontouchend="stop()">HOLD TO RACE!</button></div><script>let progress=0,clicking=false,gameWon=false,drainRate=${params.drain || 1.2},drainProgress=0;function c(){if(gameWon)return;clicking=true;click()}function stop(){clicking=false}function click(){if(!clicking||gameWon)return;progress=Math.min(progress+2.5,100);updateBar();if(progress>=100){win();return}setTimeout(click,40)}function drain(){if(gameWon)return;if(!clicking){drainProgress=Math.min(drainProgress+drainRate,100);if(drainProgress>=100){lose();return}}else{drainProgress=Math.max(drainProgress-0.5,0)}updateBar();setTimeout(drain,100)}function updateBar(){document.getElementById('pf').style.width=progress+'%';document.getElementById('pd').style.width=drainProgress+'%';if(progress>=100){document.getElementById('status').textContent='‚úÖ Victory! You won the race!';document.getElementById('status').style.color='#28a745'}else if(drainProgress>=100){document.getElementById('status').textContent='‚ùå Game Over! Red bar filled up!';document.getElementById('status').style.color='#dc3545'}}function win(){gameWon=true;const btn=document.getElementById('b');btn.textContent='Continue';btn.style.background='#28a745';btn.onmousedown=btn.ontouchstart=()=>location.href='${nextUrl}';btn.onmouseup=btn.ontouchend=null}function lose(){gameWon=true;const btn=document.getElementById('b');btn.textContent='Try Again';btn.style.background='#6c757d';btn.onmousedown=btn.ontouchstart=()=>location.reload();btn.onmouseup=btn.ontouchend=null}drain()</script></body></html>`,
  
  click_racing_rigged: (id, params, nextUrl) => `<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Loading</title><style>body{font-family:Arial;background:#f0f0f0;margin:0;padding:20px;display:flex;align-items:center;justify-content:center;min-height:100vh}.w{background:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 6px rgba(0,0,0,0.1);max-width:400px;text-align:center}.b{background:#dc3545;color:#fff;border:none;padding:20px 40px;font-size:20px;border-radius:5px;cursor:pointer;margin:20px;user-select:none}.b:active{background:#c82333;transform:scale(0.98)}.p{width:100%;background:#e0e0e0;border-radius:15px;height:30px;margin:20px 0;overflow:hidden;position:relative}.pf{height:100%;background:linear-gradient(90deg,#28a745,#20c997);width:0%;transition:width 0.1s ease}.status{font-size:18px;font-weight:bold;color:#dc3545}</style></head><body><div class="w"><h3>üèÅ Racing Challenge</h3><div class="status" id="status">Click fast to fill the bar!</div><div class="p"><div class="pf" id="pf"></div></div><button class="b" id="b" onmousedown="c()" onmouseup="stop()" ontouchstart="c()" ontouchend="stop()">CLICK FAST!</button></div><script>let progress=0,clicking=false,gameWon=false,timer=${params.realDuration || 20}*1000,lastClick=0,riggedActive=true;function c(){if(gameWon)return;clicking=true;lastClick=Date.now();click()}function stop(){clicking=false}function click(){if(!clicking||gameWon)return;if(riggedActive){progress=Math.min(progress+1.5,${params.maxProgress || 80});if(progress>=${params.maxProgress || 80}){setTimeout(()=>{progress=${params.resetPoint || 25};updateBar()},200)}}else{progress=Math.min(progress+3,100)}updateBar();if(progress>=100){win();return}setTimeout(click,50)}function updateTimer(){if(gameWon)return;if(Date.now()-lastClick>1000){timer-=100}else{timer-=Date.now()-lastClick>100?100:Date.now()-lastClick}if(timer<=0){riggedActive=false}setTimeout(updateTimer,100)}function updateBar(){document.getElementById('pf').style.width=progress+'%';if(progress>=100){document.getElementById('status').textContent='Success!';document.getElementById('status').style.color='#28a745'}}function win(){gameWon=true;const btn=document.getElementById('b');btn.textContent='Continue';btn.style.background='#28a745';btn.onmousedown=btn.ontouchstart=()=>location.href='${nextUrl}';btn.onmouseup=btn.ontouchend=null}updateTimer()</script></body></html>`
};

module.exports = { minimalTemplates };